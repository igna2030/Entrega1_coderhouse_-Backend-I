<!DOCTYPE html>
<html lang="es">

<head>
    </head>

<body>
    <div class="navbar">
        <a href="/" class=".btn-link-style">Inicio</a>
        <a href="/carts" class=".btn-link-style">Ver Carritos</a>
    </div>
    <header>
        <h1>Catálogo de Productos</h1>
    </header>
    <hr>
    
    <div class="controls-bar" style="text-align: center; margin-bottom: 20px;">
        <form id="sortForm" action="/products" method="GET" style="display: inline-block;">
            <label for="sort-select" style="font-weight: bold;">Ordenar por Precio:</label>
            <select id="sort-select" name="sort" onchange="this.form.submit()" style="padding: 8px; border-radius: 4px;">
                
                <option value="" {{#if (eq currentSort undefined)}}selected{{/if}}>-- Por Defecto --</option>
                
                <option value="asc" {{#if (eq currentSort 'asc')}}selected{{/if}}>Precio: Menor a Mayor</option>
                
                <option value="desc" {{#if (eq currentSort 'desc')}}selected{{/if}}>Precio: Mayor a Menor</option>
            </select>
            
            {{#if currentLimit}}
                <input type="hidden" name="limit" value="{{currentLimit}}">
            {{/if}}
            {{#if currentQuery}}
                <input type="hidden" name="query" value="{{currentQuery}}">
            {{/if}}
            
        </form>
    </div>

    <div class="products-list">
        {{#each products}}
        <div class="product-card">
            <h2>{{title}}</h2>
            <p>{{description}}</p>
            <p>${{price}}</p>
            <p>Stock: {{stock}} | Categoría: {{category}}</p>

            <div style="display: flex; align-items: center; gap: 20px;">
                <a href="/products/{{_id}}">
                    Ver Detalle
                </a>

                <form class="add-to-cart-form" data-product-id="{{_id}}">
                    <div class="form-group">
                        <input type="text" name="cartId" placeholder="ID Carrito" required
                            title="Ingrese el ID del carrito">
                    </div>
                    <button type="submit">
                        Añadir al Carrito
                    </button>
                </form>
            </div>
        </div>
        {{else}}
        <p style="text-align: center; width: 100%;">No se encontraron productos en el catálogo.</p>        
        {{/each}}
    </div>

    <div class="pagination-container">
        {{#if hasPrevPage}}
        <a href="{{prevLink}}">
            Página Anterior
        </a>
        {{else}}
        <span class="disabled-link">Página Anterior</span>
        {{/if}}

        <span class="current-page-number">{{currentPage}}</span>

        {{#if hasNextPage}}
        <a href="{{nextLink}}">
            Página Siguiente
        </a>
        {{else}}
        <span class="disabled-link">Página Siguiente</span>
        {{/if}}
    </div>
    
    </body>

</html>